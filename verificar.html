<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Permiso Vigente</title>
<style>
body { font-family: Arial, Helvetica, sans-serif; background: #cfe9d8; margin: 0; padding: 0; }
.wrap { max-width: 600px; margin: 18px auto; padding: 10px; }
.card { background: white; border-radius: 8px; padding: 18px; box-shadow: 0px 1px 3px rgba(0,0,0,0.25); }
.circle { width: 260px; height: 180px; background: #2ea54a; border-radius: 50%; color: white; font-weight: 900; font-size: 32px; display: flex; margin: 0 auto 15px auto; justify-content: center; align-items: center; text-align: center; line-height: 36px; text-transform: uppercase; }
h2 { text-align: center; font-size: 22px; color: #003B2E; margin-bottom: 6px; font-weight: bold; text-transform: uppercase; }
.timestamp { text-align: center; color: #003B2E; font-size: 13px; margin-bottom: 18px; font-weight: bold; }
table { width: 100%; border-collapse: collapse; font-size: 15px; }
td { padding: 10px; border: 1px solid #d0d0d0; }
.label { background: #e1f4e6; color: #003B2E; font-weight: bold; width: 48%; text-transform: uppercase; }
.value { font-weight: bold; color: #003B2E; }
.btn { display: block; width: 100%; background: #2ea54a; border: none; padding: 12px; margin-top: 22px; border-radius: 8px; color: white; font-weight: bold; cursor: pointer; font-size: 16px; text-transform: uppercase; }
</style>
</head>
<body>
<div class="wrap">
<div class="card">
<div class="circle">¡Permiso<br>Vigente!</div>
<h2>Permiso de Importación de Auto Americano</h2>
<p class="timestamp" id="timestamp"></p>
<table>
<tr><td class="label">FOLIO PERMISO:</td><td class="value" id="folio"></td></tr>
<tr><td class="label">FECHA DE ALTA:</td><td class="value" id="fechaAlta"></td></tr>
<tr><td class="label">FECHA MÁXIMA DE RETORNO:</td><td class="value" id="fechaRetorno"></td></tr>
<tr><td class="label">DIAS DISPONIBLES:</td><td class="value" id="dias"></td></tr>
<tr><td class="label">MARCA:</td><td class="value" id="marca"></td></tr>
<tr><td class="label">VIN:</td><td class="value" id="vin"></td></tr>
<tr><td class="label">MODELO:</td><td class="value" id="modelo"></td></tr>
<tr><td class="label">ESTATUS PERMISO:</td><td class="value">VIGENTE</td></tr>
<tr><td class="label">REMOLQUE:</td><td class="value">SIN REMOLQUE</td></tr>
</table>
<button class="btn" onclick="window.history.back()">Cerrar</button>
</div>
</div>

<script>
const p = new URLSearchParams(window.location.search);
document.getElementById("folio").textContent = p.get("folio");
document.getElementById("marca").textContent = p.get("marca");
document.getElementById("modelo").textContent = p.get("modelo");

const vinFull = p.get("vinFull");
const vinLast8 = vinFull.slice(-8);
document.getElementById("vin").textContent = "********" + vinLast8;

const now = new Date();
const months = ["ENE","FEB","MAR","ABR","MAY","JUN","JUL","AGO","SEP","OCT","NOV","DIC"];

document.getElementById("timestamp").textContent =
"FECHA Y HORA DE CONSULTA: " +
String(now.getDate()).padStart(2,"0") + "/" +
months[now.getMonth()] + "/" +
now.getFullYear() + " " +
String(now.getHours()).padStart(2,"0") + ":" +
String(now.getMinutes()).padStart(2,"0") + ":" +
String(now.getSeconds()).padStart(2,"0");

const total = 180;
const base = new Date(2024,0,1);
const diffMs = now - base;
const daysPassed = Math.floor(diffMs / (1000*60*60*24));
let dias = total - (daysPassed % total);
if (dias < 30) dias = 30;
document.getElementById("dias").textContent = dias;

const fechaAltaCalc = new Date(now.getTime() - (180 - dias) * 86400000);
document.getElementById("fechaAlta").textContent =
String(fechaAltaCalc.getDate()).padStart(2,"0") + "/" +
months[fechaAltaCalc.getMonth()] + "/" +
fechaAltaCalc.getFullYear();

const fechaRetornoCalc = new Date(fechaAltaCalc.getTime() + 180 * 86400000);
document.getElementById("fechaRetorno").textContent =
String(fechaRetornoCalc.getDate()).padStart(2,"0") + "/" +
months[fechaRetornoCalc.getMonth()] + "/" +
fechaRetornoCalc.getFullYear();
</script>

</body>
</html>
