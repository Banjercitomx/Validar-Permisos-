<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Valida tu Permiso</title>
<style>
  body{font-family:Arial,Helvetica,sans-serif;background:#e5e5e5;margin:0;padding:0;}
  .container{max-width:480px;background:#fff;margin:26px auto;padding:22px;border-radius:8px;}
  h2{text-align:center;font-size:26px;margin:0 0 6px;}
  p{text-align:center;color:#444;font-size:14px;margin-top:6px;}
  label{display:block;margin-top:16px;font-size:13px;font-weight:700;color:#333;}
  input[type=text]{width:100%;padding:12px;margin-top:8px;border:1px solid #ccc;border-radius:6px;font-size:16px;box-sizing:border-box;}
  .captcha{font-size:26px;text-align:center;margin-top:20px;font-family:monospace;letter-spacing:4px;color:#222;}
  .button-row{display:flex;margin-top:18px;gap:8px;}
  button{flex:1;padding:12px;border:none;cursor:pointer;font-size:16px;border-radius:6px;color:#fff;}
  .limpiar{background:#4CAF50;}
  .validar{background:#2E8B57;}
</style>
</head>
<body>
<div class="container">
  <h2>Valida tu Permiso</h2>
  <p>Por favor, captura los datos que se encuentran en tu Permiso de Importación</p>

  <label>FOLIO DE PERMISO:</label>
  <input id="folio" type="text" maxlength="12">

  <label>ÚLTIMOS 5 CARACTERES DEL NÚMERO DE SERIE (VIN):</label>
  <input id="vin" type="text" maxlength="5">

  <label>ÚLTIMOS 5 CARACTERES DEL NÚMERO DE DOCUMENTO O RFC:</label>
  <input id="rfc" type="text" maxlength="5">

  <div class="captcha" id="captchaText"></div>
  <input id="captchaInput" type="text" placeholder="Ingresa el código" style="margin-top:10px;padding:10px;border-radius:6px;border:1px solid #ccc;width:100%;">

  <div class="button-row">
    <button class="limpiar" onclick="limpiar()">LIMPIAR</button>
    <button class="validar" onclick="validar()">VALIDAR</button>
  </div>
</div>

<script>
// Vehicles Database (4 vehicles)
const vehicles = [
  {folio: "50984679", marca:"TOYOTA", vinFull:"3TMLB5JN1RM011856", vinLast5:"11856", modelo:"2024", rfcLast5:"50278"},
  {folio: "50387787", marca:"CHEVROLET", vinFull:"1GCPWBEH6MZ117056", vinLast5:"17056", modelo:"2021", rfcLast5:"05943"},
  {folio: "50497849", marca:"HONDA", vinFull:"5J6RW2H59HL056248", vinLast5:"56248", modelo:"2017", rfcLast5:"50278"},
  {folio: "50697845", marca:"CHEVROLET", vinFull:"3GCUYEED6MG476841", vinLast5:"76841", modelo:"2021", rfcLast5:"05943"}
];

function generarCaptcha(){
  const chars = "ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnpqrstuvwxyz23456789";
  let c="";
  for(let i=0;i<6;i++) c+=chars.charAt(Math.floor(Math.random()*chars.length));
  document.getElementById("captchaText").textContent = c;
}
generarCaptcha();

function limpiar(){
  document.getElementById("folio").value="";
  document.getElementById("vin").value="";
  document.getElementById("rfc").value="";
  document.getElementById("captchaInput").value="";
  generarCaptcha();
}

function validar(){
  const cap = document.getElementById("captchaText").textContent.trim();
  const inputCap = document.getElementById("captchaInput").value.trim();
  if(cap !== inputCap){ alert("CAPTCHA incorrecto"); return; }

  const folio=document.getElementById("folio").value.trim();
  const vin=document.getElementById("vin").value.trim();
  const rfc=document.getElementById("rfc").value.trim();

  const found = vehicles.find(v => 
    v.folio===folio &&
    v.vinLast5.toLowerCase()===vin.toLowerCase() &&
    v.rfcLast5.toLowerCase()===rfc.toLowerCase()
  );

  if(!found){ alert("Datos no encontrados."); return; }

  const params = new URLSearchParams(found);
  window.location.href = "verificar.html?" + params.toString();
}
</script>
</body>
</html>
